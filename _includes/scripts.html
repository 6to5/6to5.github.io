{% for js_source in site.default_js %}
  <script src='{{ js_source }}' defer></script>
{% endfor %}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    $("html").removeClass("no-js").addClass("js");
  });
</script>

{% if page.third_party_js %}
  {% for js_source in page.third_party_js %}
    <script src='{{ js_source }}' defer></script>
  {% endfor %}
{% endif %}

{% if page.custom_js %}
  {% for js_file in page.custom_js %}
    <script src='/scripts/{{ js_file }}' defer></script>
  {% endfor %}
{% endif %}

{% if layout.custom_js_with_timestamps %}
  {% for js_file in layout.custom_js_with_timestamps %}
    <script src="/scripts/{{ js_file | prepend: site.baseurl }}?tloda={{ site.time | date_to_xmlschema }}" defer></script>
  {% endfor %}
{% endif %}

{% if page.custom_js_with_timestamps %}
  {% for js_file in page.custom_js_with_timestamps %}
    <script src="/scripts/{{ js_file | prepend: site.baseurl }}?t={{ site.time | date_to_xmlschema }}" defer></script>
  {% endfor %}
{% endif %}

{% if page.webpack_js %}
  {% if jekyll.environment == "development" %}
    <script>
    /* If the webpack dev server is not running, just load via Jekyll server */
    function webpackNotAvailable(file) {
      var script = document.createElement('script');
      script.src = '/build/' + file + '.js';
      document.head.appendChild(script);
    }
    </script>
  {% endif %}
  {% for js_file in page.webpack_js %}
    {% if jekyll.environment == "development" %}
      <script src="http://localhost:34512/{{ js_file }}.js" onerror="webpackNotAvailable('{{ js_file }}')" defer></script>
    {% else %}
      <script src="/build/{{ js_file }}.js?t={{ site.time | date_to_xmlschema }}" defer></script>
    {% endif %}
  {% endfor %}
{% endif %}
